apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component
resources:
- grafana-dashboard-sources.yaml
- grafana-dashboard-node-exporter-full.yaml
- grafana-dashboard-definitions.yaml
patches:
- target:
    group: apps
    version: v1
    kind: Deployment
    name: grafana
    namespace: infra-monitoring
  patch: |-
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboards
        name: grafana-dashboards
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-alertmanager-overview
        name: grafana-dashboard-alertmanager-overview
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-apiserver
        name: grafana-dashboard-apiserver
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-cluster-total
        name: grafana-dashboard-cluster-total
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-controller-manager
        name: grafana-dashboard-controller-manager
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-grafana-overview
        name: grafana-dashboard-grafana-overview
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-k8s-resources-cluster
        name: grafana-dashboard-k8s-resources-cluster
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-k8s-resources-namespace
        name: grafana-dashboard-k8s-resources-namespace
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-k8s-resources-node
        name: grafana-dashboard-k8s-resources-node
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-k8s-resources-pod
        name: grafana-dashboard-k8s-resources-pod
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-k8s-resources-workload
        name: grafana-dashboard-k8s-resources-workload
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-k8s-resources-workloads-namespace
        name: grafana-dashboard-k8s-resources-workloads-namespace
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-kubelet
        name: grafana-dashboard-kubelet
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-namespace-by-pod
        name: grafana-dashboard-namespace-by-pod
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-namespace-by-workload
        name: grafana-dashboard-namespace-by-workload
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-node-cluster-rsrc-use
        name: grafana-dashboard-node-cluster-rsrc-use
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-node-rsrc-use
        name: grafana-dashboard-node-rsrc-use
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-nodes-darwin
        name: grafana-dashboard-nodes-darwin
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-nodes
        name: grafana-dashboard-nodes
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-persistentvolumesusage
        name: grafana-dashboard-persistentvolumesusage
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-pod-total
        name: grafana-dashboard-pod-total
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-prometheus-remote-write
        name: grafana-dashboard-prometheus-remote-write
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-prometheus
        name: grafana-dashboard-prometheus
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-proxy
        name: grafana-dashboard-proxy
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-scheduler
        name: grafana-dashboard-scheduler
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-workload-total
        name: grafana-dashboard-workload-total
    - op: add
      path: /spec/template/spec/volumes/-
      value:  
        configMap:
          name: grafana-dashboard-node-exporter-full
        name: grafana-dashboard-node-exporter-full
- target:
    group: apps
    version: v1
    kind: Deployment
    name: grafana
    namespace: infra-monitoring
  patch: |-
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        mountPath: /grafana-dashboard-definitions/0/alertmanager-overview
        name: grafana-dashboard-alertmanager-overview
        readOnly: false
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/apiserver
        name: grafana-dashboard-apiserver
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/cluster-total
        name: grafana-dashboard-cluster-total
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/controller-manager
        name: grafana-dashboard-controller-manager
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/grafana-overview
        name: grafana-dashboard-grafana-overview
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/k8s-resources-cluster
        name: grafana-dashboard-k8s-resources-cluster
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/k8s-resources-namespace
        name: grafana-dashboard-k8s-resources-namespace
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/k8s-resources-node
        name: grafana-dashboard-k8s-resources-node
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/k8s-resources-pod
        name: grafana-dashboard-k8s-resources-pod
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/k8s-resources-workload
        name: grafana-dashboard-k8s-resources-workload
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/k8s-resources-workloads-namespace
        name: grafana-dashboard-k8s-resources-workloads-namespace
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/kubelet
        name: grafana-dashboard-kubelet
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/namespace-by-pod
        name: grafana-dashboard-namespace-by-pod
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/namespace-by-workload
        name: grafana-dashboard-namespace-by-workload
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/node-cluster-rsrc-use
        name: grafana-dashboard-node-cluster-rsrc-use
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/node-rsrc-use
        name: grafana-dashboard-node-rsrc-use
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/nodes-darwin
        name: grafana-dashboard-nodes-darwin
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/nodes
        name: grafana-dashboard-nodes
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/persistentvolumesusage
        name: grafana-dashboard-persistentvolumesusage
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/pod-total
        name: grafana-dashboard-pod-total
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/prometheus-remote-write
        name: grafana-dashboard-prometheus-remote-write
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/prometheus
        name: grafana-dashboard-prometheus
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/proxy
        name: grafana-dashboard-proxy
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/scheduler
        name: grafana-dashboard-scheduler
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/workload-total
        name: grafana-dashboard-workload-total
    - op: add
      path: /spec/template/spec/containers/0/volumeMounts/-
      value:
        readOnly: false
        mountPath: /grafana-dashboard-definitions/0/node-exporter-full
        name: grafana-dashboard-node-exporter-full
        readOnly: false